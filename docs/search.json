[
  {
    "objectID": "bumps.html#basic-bump-chart-in-ggplot",
    "href": "bumps.html#basic-bump-chart-in-ggplot",
    "title": "10  Bump charts",
    "section": "10.1 Basic Bump Chart in ggplot()",
    "text": "10.1 Basic Bump Chart in ggplot()\nWe can look at how to make a bump chart using basic ggplot2 syntax. We’ll recreate the above chart. Let’s import the data:\n\nlibrary(tidyverse)\n\ndf <- read_csv(\"data_raw/torpids.csv\")\nhead(df)\n\n# A tibble: 6 x 8\n  Team            Day1  Day2  Day3  Day4  Day5  Day6  Day7\n  <chr>          <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n1 Exeter             1     2     3     3     4     5     4\n2 Brasenose          2     1     1     1     1     1     1\n3 Balliol            3     4     4     5     6     7     8\n4 Corpus Christi     4     3     2     2     2     3     3\n5 Pembroke           5     5     6     7     8     9     9\n6 Trinity            6     7     7     6     5     4     5\n\n\nWe have 12 rows of data. Each row is a college team. There are eight columns with the last seven being the ranking of each college on that day. To turn the data into a plottable format, we need to have a long data frame with columns team, day and rank.\n\ndfl <- df %>%\n  pivot_longer(cols=2:8, names_to = \"day\", values_to = \"rank\")\nhead(dfl)\n\n# A tibble: 6 x 3\n  Team   day    rank\n  <chr>  <chr> <dbl>\n1 Exeter Day1      1\n2 Exeter Day2      2\n3 Exeter Day3      3\n4 Exeter Day4      3\n5 Exeter Day5      4\n6 Exeter Day6      5\n\n\nWe can now plot day against rank using a combination of geom_line() and geom_plot(). First we will create a plot color with a legend depicting each college. We use scale_y_reverse() to plot the rankings on the y-axis from highest rank at the top of the plot to lowest ranking at the bottom.\n\nggplot(dfl, aes(x = day, y = rank, color = Team, group = Team)) +\n  geom_line(lwd=1) +\n  geom_point(size=4) +\n  xlab(\"\")+\n  scale_y_reverse(breaks=1:12) +\n  theme_classic()\n\n\n\n\nHowever, I think this plot is a little too colorful. Alternatively, we could create the plot in one color and add labels on the y-axis that have the names of the original ranks of teams. This would be more similar to the original plot:\n\nggplot(dfl, aes(x = day, y = rank, group = Team)) +\n  geom_line(lwd=1) +\n  geom_point(size=4) +\n  xlab(\"\")+\n  scale_y_reverse(breaks=1:12, labels = df$Team) +\n  theme_classic()\n\n\n\n\nThere are probably several stylistic changes we could make to this plot to make it more visually appealing. It’s often nice with bump charts to have the dots be empty circles. We can do this by adding smaller white points on top of the points that we already plotted:\n\nggplot(dfl, aes(x = day, y = rank, group = Team)) +\n  geom_line(lwd=1) +\n  geom_point(size=4) +\n  geom_point(color = \"#FFFFFF\", size = 2) +\n  scale_y_reverse(breaks=1:12, labels = df$Team) +\n  xlab(\"\") +\n  ylab(\"\") +\n  theme_classic() \n\n\n\n\nIn this plot, I have used the theme() function to remove the y axis line and tick marks and to make the text larger.\n\nggplot(dfl, aes(x = day, y = rank, group = Team)) +\n  geom_line(lwd=1) +\n  geom_point(size=4) +\n  geom_point(color = \"#FFFFFF\", size = 2) +\n  scale_y_reverse(breaks=1:12, labels = df$Team) +\n  xlab(\"\") +\n  ylab(\"\") +\n  theme_classic() +\n  theme(\n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        axis.text.y = element_text(size = rel(1.5))\n        )\n\n\n\n\nHighlighting Individual Groups\nAnother thing that is often beneficial in bump charts is to highlight individual groups of interest. This is particularly useful if there are lots of subjects. For example, let’s say we are interested in the change in ranking of the Trinity boat over time. What we would like to do is make the other lines more transparent and to make Trinity’s line bolder. To do this, we use alpha() to set the transparencies of the other crews and I also made their colors grayer. Then I create a dataframe that only includes Trinity’s data to plot over the top of our plot, and change the color of their points and lines and thicken their line to emphasize it.\n\nTrinity <- dfl %>% filter(Team==\"Trinity\")\n\nggplot(dfl, aes(x = day, y = rank, group = Team)) +\n  geom_line(lwd=1, color=\"gray50\", alpha=.3) +\n  geom_point(size=4, color=\"gray50\", alpha=.3) +\n  geom_line(data=Trinity, lwd=2, color=\"#710909\") +\n  geom_point(data=Trinity, size=4, color=\"#710909\") +\n  geom_point(color = \"#FFFFFF\", size = 2) +\n  scale_y_reverse(breaks=1:12, labels = df$Team) +\n  xlab(\"\") +\n  ylab(\"\") +\n  theme_classic() +\n  theme(\n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        axis.text.y = element_text(size = rel(1.5))\n        )"
  },
  {
    "objectID": "bumps.html#ggbump-package",
    "href": "bumps.html#ggbump-package",
    "title": "10  Bump charts",
    "section": "10.2 ggbump() package",
    "text": "10.2 ggbump() package\nI like the classic angular lines aesthetic of bump charts. However, there may be use cases where we wish to have curved lines joining points. This can be done effectively with the ggbump package.\nThe below code creates the generic plot for the college bumps dataset above. I’ve kept the scale_y_reverse() in the code so that we have the highest ranked team (i.e. 1) at the top of the y-axis, and the lowest ranked at the bottom. The geom_bump() function adds a curved line rather than straight line for each subject across time. The other difference is that I have made the day column numeric by using as.numeric(factor(day)) rather than just day. Although geom_bump() should work with characters, I have found that converting them to numeric variables works best.\n\nlibrary(ggbump)\n\nggplot(dfl, aes(as.numeric(factor(day)), rank, color = Team)) +\n    geom_bump(size=1) +\n    scale_y_reverse(breaks=1:12) \n\n\n\n\nBelow I have customized this plot with some additional code. I have decided to create a palette of 12 colors using the viridis palette, though having 12 separate colors for a discrete category is probably pushing the limits of what is easily interpretable. These colors would be added in alphabetical order as a default as the Team variable is a character. This would mean that Balliol would have the darkest purple color and Wadham the lightest yellow. A better way of assigning color would be by initial or final rank. I decided to assign here by initial rank. Therefore I converted the Team variable to a factor and made the levels the order of ranks on the first day. The easiest way to do this was to use unique(dfl$Team) as they appear in rank order of the first day in the dataset.\n\nlibrary(viridis) #for color scale\n\n#refactor Team to be in rank order (same as order appears in dataset)\ndfl$Team <- factor(dfl$Team, levels = unique(dfl$Team))\n\nggplot(dfl, aes(as.numeric(factor(day)), rank, color = Team)) +\n  geom_bump(size=1) +\n  geom_point(size=4) +\n  geom_point(color = \"#FFFFFF\", size = 2) +\n  scale_x_continuous(breaks=1:7) +\n  scale_y_reverse(breaks=1:12, labels = df$Team) +\n  scale_color_manual(values=viridis(12,option=\"C\")) +\n  xlab(\"Day\") +\n  ylab(\"Rank\") +\n  theme_classic() +\n  xlab(\"Day\") +\n  ylab(\"\") +\n  theme_classic() +\n  theme(\n    axis.ticks.y = element_blank(),\n    axis.line.y = element_blank(),\n    axis.text.y = element_text(size = rel(1.5)),\n    legend.position = \"none\"\n  )\n\n\n\n\n\n10.2.1 Practical Example - Babyname Popularity Over Time.\nhttps://github.com/steodose/Tidy-Tuesday/blob/master/Week%2028_2022.R"
  },
  {
    "objectID": "savingexporting.html#ggsave",
    "href": "savingexporting.html#ggsave",
    "title": "11  Saving and Exporting Plots",
    "section": "11.1 ggsave()",
    "text": "11.1 ggsave()\nA more premium option is to use a function from ggplot called ggsave(). The first step you should do is to assign your plot to an object name. In the code below, we are making a scatterplot that we save to the object plot1:\n\nlibrary(tidyverse)\n\ncheese <- read_csv(\"data_raw/cheese.csv\")\n\nplot1 <- ggplot(cheese, aes(x = chol, y = kcal)) + \n     geom_point(color='purple', size=2) + \n     theme_classic() +\n     xlab(\"Cholesterol\") +\n     ylab(\"Calories in kcal\") +\n     ggtitle(\"Cheese\")\n\nplot1\n\n\n\n\nNext, run a line of code that will save your plot. You type ggsave(). The first thing you put inside this is the location where you want your plot to be stored. You need to write a location on your computer. If you are using an Rproject such as with this course, you could put your plot in a folder called img. Remember to type the file extension .png or .pdf after the name of your new plot. The second thing you need to write is the name of the graph object you wish to save. Here our graph is called plot1.\n\nggsave(\"img/cheese_plot.png\", plot1)  # save as a png\n\nggsave(\"img/cheese_plot.pdf\", plot1)  # save as a pdf\n\nYou can also play around with the width and height of your saved image. You probably need to trial and error this a few times to get the proportions that you really like. Here we are making an image that is 10 inches wide and 8 inches high.\n\n#(in inches, though can be in cm)\nggsave(\"img/cheese_plot2.png\", plot1, width = 10, height = 8)"
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "12  Summary",
    "section": "",
    "text": "There is no summary. I was just scared to delete this file."
  }
]